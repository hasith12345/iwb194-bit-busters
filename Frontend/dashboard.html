<!DOCTYPE html>
<html lang="en" class="light">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Repository Dashboard</title>
        <link
            href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
            rel="stylesheet"
        />
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                darkMode: "class",
                theme: {
                    extend: {
                        colors: {
                            dark: {
                                bg: "#2d3748",
                                text: "#e2e8f0",
                                card: "#4a5568",
                            },
                            light: {
                                bg: "#f7fafc",
                                text: "#2d3748",
                                card: "#ffffff",
                            },
                            primary: {
                                DEFAULT: "#3182ce",
                                dark: "#2b6cb0",
                            },
                        },
                        fontFamily: {
                            poppins: ["Poppins", "sans-serif"],
                        },
                    },
                },
            };
        </script>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
        />
    </head>
    <body
        class="bg-light-bg dark:bg-dark-bg text-light-text dark:text-dark-text font-poppins transition-colors duration-300"
    >
        <div class="container mx-auto px-4 py-10">
            <div class="flex flex-col items-center mb-8">
                <!-- GitHub Logo -->
                <img
                    src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"
                    alt="GitHub Logo"
                    class="h-16 mb-4"
                />
                <h1
                    class="text-4xl font-bold text-primary dark:text-blue-400 transition duration-200 text-center"
                >
                    Repository Dashboard
                </h1>
                <button
                    id="dark-mode-toggle"
                    class="p-3 rounded-full bg-gray-200 dark:bg-gray-700 transition duration-300 transform hover:scale-105 mt-4"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="h-6 w-6 text-gray-800 dark:text-yellow-300"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                        />
                    </svg>
                </button>
            </div>
            <div id="search-container" class="mb-8 flex flex-col items-center">
                <input
                    type="text"
                    id="repo-url"
                    placeholder="Enter GitHub repository URL"
                    required
                    class="w-full md:w-2/3 p-3 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-dark-card dark:text-dark-text transition duration-300 mb-4"
                />
                <button
                    id="search-btn"
                    class="bg-primary hover:bg-primary-dark dark:bg-blue-600 dark:hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-md transition duration-300"
                >
                    Search
                </button>
                <p
                    id="error-message"
                    class="text-red-500 dark:text-red-400 mt-2 hidden"
                ></p>
            </div>
            <div
                id="stats"
                class="bg-white dark:bg-dark-card shadow-lg rounded-md p-6 mb-6 hidden transition duration-300"
            ></div>
            <div
                id="repo-info"
                class="bg-white dark:bg-dark-card shadow-lg rounded-md p-6 mb-6 hidden transition duration-300"
            ></div>
            <div
                id="owner-info"
                class="bg-white dark:bg-dark-card shadow-lg rounded-md p-6 mb-6 hidden transition duration-300"
            ></div>
            <div
                id="settings"
                class="bg-white dark:bg-dark-card shadow-lg rounded-md p-6 mb-6 hidden transition duration-300"
            ></div>
            <div
                id="urls"
                class="bg-white dark:bg-dark-card shadow-lg rounded-md p-6 mb-6 hidden transition duration-300"
            ></div>
        </div>

        <script>
            function createInfoElement(label, value, icon) {
                return `
                <p class="mb-2 flex items-center">
                    <span class="mr-2"><i class="${icon} text-primary dark:text-blue-400"></i></span>
                    <span class="font-semibold">${label}:</span>
                    <span class="ml-2">${value}</span>
                </p>`;
            }

            function formatDate(dateString) {
                return new Date(dateString).toLocaleString();
            }

            function showError(message) {
                const errorElement = document.getElementById("error-message");
                errorElement.textContent = message;
                errorElement.classList.remove("hidden");
            }

            function hideError() {
                document
                    .getElementById("error-message")
                    .classList.add("hidden");
            }

            function showElement(id) {
                document.getElementById(id).classList.remove("hidden");
            }

            function hideAllCards() {
                [
                    "stats",
                    "repo-info",
                    "owner-info",
                    "settings",
                    "urls",
                ].forEach((id) => {
                    document.getElementById(id).classList.add("hidden");
                });
            }

            function parseGitHubUrl(url) {
                const match = url.match(/github\.com\/([^\/]+)\/([^\/]+)/);
                return match ? { owner: match[1], repo: match[2] } : null;
            }

            async function fetchRepoData(owner, repo) {
                const response = await fetch(
                    `https://api.github.com/repos/${owner}/${repo}`
                );
                if (!response.ok) {
                    throw new Error(
                        response.status === 404
                            ? "Repository not found"
                            : "API request failed"
                    );
                }
                return response.json();
            }

            function updateDashboard(repoData) {
                document.getElementById("stats").innerHTML = `
                <h2 class="text-2xl font-bold text-primary dark:text-blue-400 mb-4">Statistics</h2>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <div class="bg-blue-100 dark:bg-blue-900 p-4 rounded-md">
                        <p class="text-2xl font-bold text-blue-600 dark:text-blue-300">${repoData.stargazers_count}</p>
                        <p class="text-sm text-blue-500 dark:text-blue-400">Stars</p>
                    </div>
                    <div class="bg-green-100 dark:bg-green-900 p-4 rounded-md">
                        <p class="text-2xl font-bold text-green-600 dark:text-green-300">${repoData.watchers_count}</p>
                        <p class="text-sm text-green-500 dark:text-green-400">Watchers</p>
                    </div>
                    <div class="bg-yellow-100 dark:bg-yellow-900 p-4 rounded-md">
                        <p class="text-2xl font-bold text-yellow-600 dark:text-yellow-300">${repoData.forks_count}</p>
                        <p class="text-sm text-yellow-500 dark:text-yellow-400">Forks</p>
                    </div>
                    <div class="bg-red-100 dark:bg-red-900 p-4 rounded-md">
                        <p class="text-2xl font-bold text-red-600 dark:text-red-300">${repoData.open_issues_count}</p>
                        <p class="text-sm text-red-500 dark:text-red-400">Open Issues</p>
                    </div>
                    <div class="bg-purple-100 dark:bg-purple-900 p-4 rounded-md">
                        <p class="text-2xl font-bold text-purple-600 dark:text-purple-300">${repoData.size} KB</p>
                        <p class="text-sm text-purple-500 dark:text-purple-400">Size</p>
                    </div>
                </div>`;

                document.getElementById("repo-info").innerHTML = `
                <h2 class="text-2xl font-bold text-primary dark:text-blue-400 mb-4">Repository Information</h2>
                ${createInfoElement("Name", repoData.name, "fas fa-repo")}
                ${createInfoElement("Full Name", repoData.full_name, "fas fa-file")}
                ${createInfoElement("ID", repoData.id, "fas fa-id-card")}
                ${createInfoElement("Description", repoData.description || "No description", "fas fa-info-circle")}
                ${createInfoElement("Visibility", repoData.visibility, "fas fa-eye")}
                ${createInfoElement("Default Branch", repoData.default_branch, "fas fa-code-branch")}
                ${createInfoElement("Created At", formatDate(repoData.created_at), "fas fa-calendar-alt")}
                ${createInfoElement("Updated At", formatDate(repoData.updated_at), "fas fa-calendar-alt")}
                ${createInfoElement("Pushed At", formatDate(repoData.pushed_at), "fas fa-calendar-alt")}
            `;

                showElement("stats");
                showElement("repo-info");
            }

            document
                .getElementById("search-btn")
                .addEventListener("click", async () => {
                    hideAllCards();
                    hideError();
                    const repoUrl = document.getElementById("repo-url").value;
                    const parsedUrl = parseGitHubUrl(repoUrl);

                    if (!parsedUrl) {
                        showError("Please enter a valid GitHub repository URL.");
                        return;
                    }

                    try {
                        const repoData = await fetchRepoData(
                            parsedUrl.owner,
                            parsedUrl.repo
                        );
                        updateDashboard(repoData);
                    } catch (error) {
                        showError(error.message);
                    }
                });

            // Dark mode toggle
            document
                .getElementById("dark-mode-toggle")
                .addEventListener("click", () => {
                    document.documentElement.classList.toggle("dark");
                });
        </script>
    </body>
</html>
